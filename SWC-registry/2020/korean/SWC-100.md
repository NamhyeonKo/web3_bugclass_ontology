# 알림: 이 콘텐츠는 더 이상 적극적으로 유지되지 않습니다.

SWC 레지스트리의 내용은 2020년 이후 철저하게 업데이트되지 않았습니다. 불완전하고 오류가 포함되어 있으며 중요한 누락이 있을 수 있습니다.

보안 검토자를 위한 지침으로 작성된 현재 유지되는 스마트 컨트랙트 취약점에 대한 안내는
[EEA EthTrust Security Levels specification](https://entethalliance.org/specs/ethtrust-sl)을 참조하십시오. 최신 릴리스 버전과 함께 사양을 개발하는 그룹의 최신 작업을 나타내는
[Editor's draft](https://entethalliance.github.io/eta-registry/security-levels-spec.html)도 제공됩니다.

현재 유지되고 있는 개발자를 위한 보안 고려사항에 대한 일반적인 지침은
[Smart Contract Security Verification Standard (SCSVS)](https://github.com/ComposableSecurity/SCSVS)를 통해서도 제공됩니다.

# 제목

함수 기본 가시성

## 관계

- [CWE-710: Improper Adherence to Coding Standards](https://cwe.mitre.org/data/definitions/710.html)
- EthTrust Security Levels:
  - [**[Q] Code Linting**](https://entethalliance.org/specs/ethtrust-sl/#req-3-linted)

## 설명

함수 가시성 타입이 지정되지 않은 함수는 기본적으로 `public`입니다. 개발자가 가시성을 설정하는 것을 잊었고 악의적인 사용자가 무단 또는 의도하지 않은 상태 변경을 할 수 있는 경우 취약점으로 이어질 수 있습니다.

## 해결방법

함수는 `external`, `public`, `internal` 또는 `private`로 지정할 수 있습니다. 함수에 적절한 가시성 타입이 무엇인지 의식적으로 결정하는 것이 권장됩니다. 이는 컨트랙트 시스템의 공격 표면을 극적으로 줄일 수 있습니다.

## 참고자료

- [Ethereum Smart Contract Best Practices - Visibility](https://consensys.github.io/smart-contract-best-practices/development-recommendations/solidity-specific/visibility/)
- [SigmaPrime - Visibility](https://github.com/sigp/solidity-security-blog#visibility)

## 샘플

### visibility_not_set.sol

```solidity
/*
 * @source: https://github.com/sigp/solidity-security-blog#visibility
 * @author: SigmaPrime
 * Modified by Gerhard Wagner
 */

pragma solidity ^0.4.24;

contract HashForEther {

    function withdrawWinnings() {
        // Winner if the last 8 hex characters of the address are 0.
        require(uint32(msg.sender) == 0);
        _sendWinnings();
     }

     function _sendWinnings() {
         msg.sender.transfer(this.balance);
     }
}

```

#### 코멘트

11번과 17번 라인의 함수 선언은 함수의 가시성을 설정하지 않았습니다. 최소한 Solidity 0.4.24
(`pragma` 문에 명시된 대로)의 경우, 이는 기본적으로 `public`으로 처리됨을 의미합니다.
이로 인해 누구나 `_sendWinings()` 함수를 호출하여 돈을 가져갈 수 있습니다.

대신, 아래의 수정된 버전은 `_sendWinnings()` 함수 가시성을 `internal`로 제한하여,
발신자가 실제로 돈을 받기 위한 조건을 충족했는지 확인하는 `WithdrawWinnings()` 함수에 의해서만 활성화될 수 있도록 합니다.

### visibility_not_set_fixed.sol

```solidity
/*
 * @source: https://github.com/sigp/solidity-security-blog#visibility
 * @author: SigmaPrime
 * Modified by Gerhard Wagner
 */

pragma solidity ^0.4.24;

contract HashForEther {

    function withdrawWinnings() public {
        // Winner if the last 8 hex characters of the address are 0.
        require(uint32(msg.sender) == 0);
        _sendWinnings();
     }

     function _sendWinnings() internal{
         msg.sender.transfer(this.balance);
     }
}

```

# 알림: 이 콘텐츠는 더 이상 적극적으로 유지되지 않습니다.

SWC 레지스트리의 내용은 2020년 이후 철저하게 업데이트되지 않았습니다. 불완전하고 오류가 포함되어 있으며 중요한 누락이 있을 수 있습니다.

보안 검토자를 위한 지침으로 작성된 현재 유지되는 스마트 컨트랙트 취약점에 대한 안내는
[EEA EthTrust Security Levels specification](https://entethalliance.org/specs/ethtrust-sl)을 참조하십시오. 최신 릴리스 버전과 함께 사양을 개발하는 그룹의 최신 작업을 나타내는
[Editor's draft](https://entethalliance.github.io/eta-registry/security-levels-spec.html)도 제공됩니다.

현재 유지되고 있는 개발자를 위한 보안 고려사항에 대한 일반적인 지침은
[Smart Contract Security Verification Standard (SCSVS)](https://github.com/ComposableSecurity/SCSVS)를 통해서도 제공됩니다.

# 제목

서명 재생 공격에 대한 보호 누락

## 관계

[CWE-347: Improper Verification of Cryptographic Signature](https://cwe.mitre.org/data/definitions/347.html)

## 설명

더 나은 사용성을 달성하거나 가스 비용을 절약하기 위해 스마트 컨트랙트에서 서명 검증을 수행해야 하는 경우가 있습니다. 안전한 구현은 예를 들어 처리된 모든 메시지 해시를 추적하고 새로운 메시지 해시만 처리하도록 허용함으로써 서명 재생 공격으로부터 보호해야 합니다. 악의적인 사용자는 이러한 제어가 없는 컨트랙트를 공격하여 다른 사용자가 보낸 메시지 해시를 여러 번 처리하도록 할 수 있습니다.

## 해결방법

서명 재생 공격으로부터 보호하기 위해 다음 권장사항을 고려하십시오:

- 스마트 컨트랙트에서 처리된 모든 메시지 해시를 저장합니다. 새로운 메시지를 받으면 이미 존재하는 메시지와 비교하여 새로운 메시지 해시인 경우에만 비즈니스 로직을 진행합니다.
- 메시지를 처리하는 컨트랙트의 주소를 포함합니다. 이렇게 하면 메시지가 단일 컨트랙트에서만 사용될 수 있습니다.
- 어떤 경우에도 서명을 포함하여 메시지 해시를 생성하지 마십시오. `ecrecover` 함수는 서명 가변성에 취약합니다(SWC-117 참조).

## 참고자료

- [Medium - Replay Attack Vulnerability in Ethereum Smart Contracts Introduced by transferProxy()](https://medium.com/cypher-core/replay-attack-vulnerability-in-ethereum-smart-contracts-introduced-by-transferproxy-124bf3694e25)
